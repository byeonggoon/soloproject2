<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <title>BGFinance</title>
    <link rel="stylesheet" href="/stylesheets/index.css">
    <script type="text/javascript" src="/javascripts/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />


<style>
    .stockname{
        overflow: hidden; 
        white-space: nowrap;
        text-overflow: ellipsis;
    }
</style>

</head>
<body>
    <div class="body">
        
        <div class="menu">
            <ul>
                <li><a href="/stock/1">주식게시판</a></li>
                <li><a href="/coin/1">코인게시판</a></li>
                <%if(data==undefined){%>
                    <li><a href="/login" rel="modal:open">로그인</a></li>
                    <li><a href="/signup" rel="modal:open">회원가입</a></li>
                    <%}else{%>
                        <li><a href="/mypage">
                                <%=data%>님
                            </a></li>
                        <li><a href="/logout">logout</a></li>
                        <%}%>
            </ul>
        </div>
        <div class="BGF">BGFinance</div>
    </div>

 
    
<!--주식,코인 시세확인 -->
<div class="toppart">
    <div class="totalpart">
        <div class="stockcontainer">
            <div class="item">
                <div class="subject">
                    코스피 주가 상승 10종목
                </div>
            </div>
            <div class="item1">
                <div id="stock_table_2">
                    <table>
                        <thead>
                            <tr>
                                <td class="stockname" width="180px">종목명</td>
                                <td>현재가</td>
                                <td>전일비</td>
                                <td>등락률</td>
                                <td>거래량</td>
                            </tr>
                        </thead>

                        <tbody>
                            <% for(i=0; i<10; i++){%>
                                <tr>
                                    <td style="max-width:180px; overflow: hidden; white-space: nowrap;">
                                        <%= arr[0][i] %>
                                    </td>
                                    <td>
                                        <%= arr[1][i] %>
                                    </td>
                                    <td class="redrate blinking">
                                        ▲ <%= arr[2][i] %>
                                    </td>
                                    <td class="redrate">
                                        <%= arr[3][i] %>
                                    </td>
                                    <td>
                                        <%= arr[4][i] %>
                                    </td>
                                </tr>
                                <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="buycontainer"><a href="https://www.kiwoom.com/nkw.template.do" class="redrate blinking2"> 사러가기</a>
            </div>
        </div>
        <div class="coincontainer">
            <div class="item">
                <div class="subject">
                    주요 코인 시세
                </div>
            </div>
            <div class="item1">
                <div id="crypto_container">
                    <table id="table_ticker1" class="table table-hover text-center">
                        <thead>
                            <tr>
                                <td width="180px" >코인명</td>
                                <td>현재가</td>
                                <td>전일비</td>
                                <td>등락률</td>
                                <td>거래량</td>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="buycontainer"> <a href="https://upbit.com/exchange?code=CRIX.UPBIT.KRW-BTC" class="redrate blinking2"> 사러가기</a>
            </div>
        </div>
    </div>
</div>


<!-- 게시판 인기글 -->
    <div class="container2 ">
        <!-- //////////////////////////////////////////////// -->
        <div class="box">
            <div class="stock_manyhits">주식게시판 인기글</div>
            <div class="stock_title">제목</div>
            <div class="stock_hit">조회수</div>
            <div class="container8">
            <% hits.forEach((main,index)=>{ %>
                <a href='/stock/detail/<%= main.no %>'><div class="stock_titlelist"><%=main.stocktitle%></div></a>
                    <% }); %>
            </div>
            <div class="container7">
                <% hits.forEach((main,index)=>{ %>
                    <div class="stock_hitlist"><%=main.views%></div>
                    <% }); %>
            </div>
        </div>
    <!-- //////////////////////////////////////////////// -->
        <div class="square">
            <div class="coin_manyhits">코인게시판 인기글</div>
            <div class="coin_title">제목</div>
            <div class="coin_hit">조회수</div>
            <div class="container8">
                <% hits2.forEach((main,index)=>{ %>
                    <a href='/coin/detail/<%= main.no %>'><div class="stock_titlelist"><%=main.cointitle%></div></a>
                        <% }); %>
                </div>
                <div class="container7">
                    <% hits2.forEach((main,index)=>{ %>
                        <div class="stock_hitlist">
                            <%=main.views%>
                        </div>
                        <% }); %>
                </div>
        </div>
    </div>



    <div class="container3">
        <div>
        <!--코인,주식동향-->
        <script type="text/javascript" src="https://ssl.gstatic.com/trends_nrtr/2431_RC04/embed_loader.js"></script>
        <script type="text/javascript">
            trends.embed.renderExploreWidget("TIMESERIES", {
                "comparisonItem": [{ "keyword": "비트코인", "geo": "", "time": "today 5-y" }, { "keyword": "주식", "geo": "", "time": "today 5-y" }],
                "category": 0, "property": ""
            }, {
                "exploreQuery": "date=today%205-y&q=%EB%B9%84%ED%8A%B8%EC%BD%94%EC%9D%B8,%EC%A3%BC%EC%8B%9D",
                "guestPath": "https://trends.google.co.kr:443/trends/embed/"
            });</script>
            </div>
    </div>



  
    
    <!-- //////////////////////////비트코인//////////////////////////////// -->
           <script> 
                //천 단위 콤마 찍기!
                    function comma(str) {
                        str = String(str);
                        return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
                    }

                    //데이터 받아오기
                    function setUpbitData() {
                        $.ajax({
                            url: "https://api.upbit.com/v1/market/all",
                            dataType: "json"
                        }).done(function (markets) {
                            let arr_krw_markets = "";
                            let arr_korean_name = [];
                            for (var i = 0; i < markets.length; i++) {
                                if (markets[i].market.indexOf("KRW") > -1) {
                                    arr_krw_markets += markets[i].market + (",");
                                    arr_korean_name.push(markets[i].korean_name.replace("코인", ""));
                                }
                            }
                            arr_krw_markets = arr_krw_markets.substring(0, arr_krw_markets.length - 1);
                            $.ajax({
                                url: "https://api.upbit.com/v1/ticker?markets=" + arr_krw_markets,
                                dataType: "json"
                            }).done(function (tickers) {
                                $("#table_ticker1 > tbody > tr").remove();

                                for (let i = 0; i < 10; i++) {  // i 값으로 페이지에 몇개 보여질지 설정 
                                    let rowHtml = "<tr><td>" + arr_korean_name[i].replace("코인", "").replace("토큰", "") + "</td>";
                                    rowHtml += "<td>" + comma(tickers[i].trade_price) + "</td>"
                                    rowHtml += "<td>" + comma((tickers[i].signed_change_price).toFixed(0)) + "</td>"
                                    rowHtml += "<td>" + comma((tickers[i].signed_change_rate * 100).toFixed(2)) + "</td>"
                                    rowHtml += "<td>" + comma((tickers[i].acc_trade_price_24h > 1000000 ? (tickers[i].acc_trade_price_24h / 1000000) : tickers[i].acc_trade_price_24h).toFixed(0)) + (tickers[i].acc_trade_price_24h > 1000000 ? "M" : "") + "</td>"
                                    rowHtml += "</tr>";
                                    $("#table_ticker1 > tbody:last").append(rowHtml);
                                }
                            })
                        })
                            .fail(function () {
                                $("#tmp").text("API 접근 중 에러.");
                            })
                        setTimeout(setUpbitData, 10000);
                    }
                    setUpbitData();



        // //////////////모달창JS/////////////
        function openModal(modalname) {
            document.get
            $("#modal").fadeIn(300);
            $("." + modalname).fadeIn(300);
        }

        $("#modal, .close").on('click', function () {
            $("#modal").fadeOut(300);
            $(".modal-con").fadeOut(300);
        });
    
            </script> 



</body>
</html>